---
title: 'Quantifiers: Part 4'
date: 2025-10-20
permalink: /posts/2025/10/blog-post-8/
tags:
  - lean
  - logic
  - quantifiers
  - forall
  - exists
  - negation
  - mixed quantifiers
---

Now that we have a handle on universal and existential quantification, we can look at propositions that involve both. In the previous posts on Quantifiers, a quantifier applied to a single variable. This is the case in this post but now we allow two quantifiers each applied to their own variable.

- ∃x ∃y P(x, y)
- ∀x ∀y P(x, y)
- ∃x ∀y P(x, y)
- ∀x ∃y P(x, y)

Prenex form writes all the quantifiers in the beginning of the sentence.

The order of the quantifiers makes a difference

## Methods of proof

```lean
/- cannot have two universal quantifiers with the same binded variable
failed to infer binder type
Note: When the resulting type of a declaration is explicitly provided, all holes (e.g., `_`)
in the header are resolved before the declaration body is processed

example : ∀ x, ∀ x, P x → Q x →  P x → Q x := by
  intro h g hg ph
  sorry
-/
-- you would just have one variable and one quantifier
example : ∀ x, P x → Q x →  P x → Q x := by
  intro h g hg ph
  exact hg

-- or else name the variable something different (requires stronger hypothesis)
example : ∀ x, ∀ n, x = n → P x → Q x → P n → Q n := by
  intro h g hg ph qh pg
  rw[hg] at qh
  exact qh
```

```lean
example : ∀ x, ∃ n, P x → Q x →  ¬ (P n ∧ ¬ Q n) := by
  intro h
  use h
  push_neg
  intro ph
  intro qh
  intro ph'
  exact qh
```

Rewriting to prenex form takes a little work, we don't just move all the quantifiers to the front. Let's look at this:
```lean
-- note how the n term is given as a hypothesis
-- this kind of proof is asking us to construct an instance x s.t. Q x
example : (h : ∀ x, P x → Q x) (n : ℕ) (hp : P n) : ∃ x, Q x := by
  have hq := h n hp  -- derive Q n
  exists n           -- Q n is given, so we can use n as a witness
                     -- the exists tactic closes these types of goals
-- note: the order of these two tactics can be reversed as well
-- note how the n term is given as a hypothesis
-- this kind of proof is asking us to construct an instance x s.t. Q x
```

One possible interpretation in prenex form is:
```lean
example : ∀ x, ∃ y, P x → Q x → Q y := by
  intro N
  use N
  intro pn qn
  exact qn 
```

Here is a closer version that includes the hypothesis `hp`:
```lean
example : ∀x, ∀n, ∃y, P x → Q x → P n → Q y := by
  intro A N
  use A
  intro pa qa pn
  exact qa
```

Here is the prenex form for the contrapositive:
```lean
example : ∀ x, ∃ y, (P x → Q x) → (¬Q y → ¬P x) := by
  intro N
  use N
  intro h
  contrapose
  push_neg
  exact h
```

But this can really be simplified to remove the redundant:
```lean
example : ∀ x, (P x → Q x) → (¬Q x → ¬P x) := by
  intro N
  intro h
  contrapose
  push_neg
  exact h
```

The universal quantifier implies the existential quantifier:
```lean
  example (P Q : ℕ → Prop) : (∀ x, P x → Q x) → (∃ x, P x → Q x) := by 
  intro N
  have n : ℕ := 0  -- instantiate a witness
  have h := N n
  use n
```

The prenex form of the previous example shows:
```lean
-- weak
example (P Q : ℕ → Prop) : ∀ x, ∃ y, ((P x → Q x) → (P y → Q y)) := by
intro N
use N
tauto
```